"use strict";(self.webpackChunkgrants=self.webpackChunkgrants||[]).push([[15154],{26708:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"applications/upgradeability-by-proxy","title":"ink! Smart Contract Upgradeability","description":"Team Name:* Fractal","source":"@site/applications/upgradeability-by-proxy.md","sourceDirName":"applications","slug":"/applications/upgradeability-by-proxy","permalink":"/applications/upgradeability-by-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/w3f/Grants-Program/edit/master/applications/upgradeability-by-proxy.md","tags":[],"version":"current","frontMatter":{}}');var r=n(74848),a=n(28453);const s={},o="ink! Smart Contract Upgradeability",l={},d=[{value:"Project Overview \ud83d\udcc4",id:"project-overview-page_facing_up",level:2},{value:"Overview",id:"overview",level:3},{value:"Project Details",id:"project-details",level:3},{value:"Ecosystem Fit",id:"ecosystem-fit",level:3},{value:"Team \ud83d\udc65",id:"team-busts_in_silhouette",level:2},{value:"Team members",id:"team-members",level:3},{value:"Contact",id:"contact",level:3},{value:"Legal Structure",id:"legal-structure",level:3},{value:"Team&#39;s experience",id:"teams-experience",level:3},{value:"Team Code Repos",id:"team-code-repos",level:3},{value:"Team LinkedIn Profiles",id:"team-linkedin-profiles",level:3},{value:"Development Roadmap \ud83d\udd29",id:"development-roadmap-nut_and_bolt",level:2},{value:"Overview",id:"overview-1",level:3},{value:"Milestone 1 \u2014 Upgradable Ink Smart contract infrastructure",id:"milestone-1--upgradable-ink-smart-contract-infrastructure",level:3},{value:"Future Plans",id:"future-plans",level:2},{value:"Additional Information \u2795",id:"additional-information-heavy_plus_sign",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"ink-smart-contract-upgradeability",children:"ink! Smart Contract Upgradeability"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Team Name:"})," Fractal"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Payment Address:"})," 0xB341F86A30390048390d6eF118d0e08bBbb0fDef"]}),"\n"]}),"\n",(0,r.jsxs)(t.h2,{id:"project-overview-page_facing_up",children:["Project Overview ","\ud83d\udcc4"]}),"\n",(0,r.jsx)(t.h3,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(t.p,{children:"The main goal of this project is to bring smart contract upgradeability to ink."}),"\n",(0,r.jsx)(t.p,{children:"Smart contract upgradeability is an important mechanism to fix security bugs in\ncontracts. It also enables post-deployment iterative development, by offering\nthe flexibility of adding new features."}),"\n",(0,r.jsx)(t.p,{children:"This mechanism should be flexible enough that contract developers may decide if\nthey want to be able to upgrade their contracts, and specify under what\nconditions."}),"\n",(0,r.jsx)(t.p,{children:"Our team is interested in this because it is very likely that our development\nefforts start with smart contracts before moving to a custom Substrate runtime.\nAnother reason upgradeability is particularly important to us is that we expect\nto iterate our logic frequently based on a continuous product discovery process."}),"\n",(0,r.jsx)(t.h3,{id:"project-details",children:"Project Details"}),"\n",(0,r.jsx)(t.p,{children:"Upgrade functionality can be implemented in user-land, or as part of the smart\ncontracts pallet. We are starting with the first option: it gives us more\nflexibility to experiment, and iterate faster towards an adequate soltuion.\nWhen we're happy with the result, we'll see what can be migrated to ink as a\ndirective to reduce boilerplate."}),"\n",(0,r.jsx)(t.p,{children:"We're going to start by implementing the proxy pattern. There are a few\nconcerns that will need to be addressed:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"figure out how to handle the separation between state and code"}),"\n",(0,r.jsx)(t.li,{children:"design a standard for data migrations on contract upgrade"}),"\n",(0,r.jsx)(t.li,{children:"design a standard for upgrade authorization"}),"\n",(0,r.jsx)(t.li,{children:"decide if the contract's public interface can/should be upgradable or static"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"We want to allow for flexibility when deciding if a smart contract can be\nupgradable or not, and under what circumstances. Should we allow upgrades to\nthe authorization code?"}),"\n",(0,r.jsx)(t.p,{children:"Upgrading the contract's public interface may not be possible when using the\nproxy pattern."}),"\n",(0,r.jsxs)(t.p,{children:["Ink's documentation and examples provide us with the delegator pattern. This\ncontract works by calling ",(0,r.jsx)(t.code,{children:"put_code"}),' once for the delegator contract and once\nfor the "delegated-to" contract. Every method that is delegated must be\nexplicitly defined in the delegator.']}),"\n",(0,r.jsx)(t.p,{children:"For milestone 1, we will build a template using this pattern with upgrade and\nauthorization methods. This is a template and not a library/ink directive\nbecause we want to focus on the upgrade pattern mechanism and leave any ink\nquality-of-life improvements, like directives or syntax sugar, for the second\nmilestone."}),"\n",(0,r.jsx)(t.p,{children:"Something that we will consider for future work is extracting any patterns into\nink directives that bring us ergonomy of use. For example, assuming we end up\ndeciding on the proxy method, we could automatically generate the proxied\nmethods."}),"\n",(0,r.jsx)(t.p,{children:"Parts of this work may be liftable to the smart contracts pallet. The\nadvantages of implementing certain features directly in the pallet is that\nthey'd be more efficient and we could tweak their incentive structure."}),"\n",(0,r.jsx)(t.h3,{id:"ecosystem-fit",children:"Ecosystem Fit"}),"\n",(0,r.jsx)(t.p,{children:"Since smart contract development is more accessible and less involved than\nruntime development, we expect most folks who build on Polkadot to benefit from\nthis mechanism. Substrate offers a natural development path from smart\ncontracts to runtime, so it's also likely that this will assist folks getting\nstarted with smart contracts even if they intend to move to a custom runtime in\nthe future."}),"\n",(0,r.jsxs)(t.p,{children:["We didn't find related ideas in the\n",(0,r.jsx)(t.a,{href:"https://github.com/w3f/General-Grants-Program",children:"https://github.com/w3f/General-Grants-Program"})," or\n",(0,r.jsx)(t.a,{href:"https://github.com/w3f/Open-Grants-Program",children:"https://github.com/w3f/Open-Grants-Program"})," repos. We also asked some folks in\nthe community, none of whom were aware of similar projects."]}),"\n",(0,r.jsxs)(t.h2,{id:"team-busts_in_silhouette",children:["Team ","\ud83d\udc65"]}),"\n",(0,r.jsx)(t.h3,{id:"team-members",children:"Team members"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://github.com/hugopeixoto/",children:"Hugo Peixoto"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://github.com/juliosantos/",children:"J\xfalio Santos"})}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"contact",children:"Contact"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Contact Name:"})," J\xfalio Santos"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Contact Email:"})," ",(0,r.jsx)(t.a,{href:"mailto:julio@fractal.id",children:"julio@fractal.id"})]}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://trustfractal.com/",children:"https://trustfractal.com/"})}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"legal-structure",children:"Legal Structure"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Registered Address:"})," Wiener Stra\xdfe 10, 10999 Berlin, Germany"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Registered Legal Entity:"})," Trust Fractal GmbH"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"teams-experience",children:"Team's experience"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Back in 2017, we've implemented a card game\n(",(0,r.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Baccarat_(card_game)",children:"Baccarat"}),") in Solidity.\nEVM and Solidity have no primitives to generate random numbers, as there is\nno trustworthy source of entropy available on the blockchain \u2014 so we\ndescribed and built a method for provably fair random number generation with\na non-repudiable commitment scheme. This was implemented using state channels\nfor reduced latency and cost. It was built for a client who now owns the IP,\nso we can't share anything else here, but can do in private if needed."]}),"\n",(0,r.jsxs)(t.li,{children:["In 2017-2018 we built and operated an ICO launchpad to help teams building on\nblockchain, such as the ",(0,r.jsx)(t.a,{href:"https://oceanprotocol.com/",children:"Ocean Protocol"}),", to\ncrowdfund their projects with community support. See ",(0,r.jsx)(t.a,{href:"https://medium.com/future-energy-ventures/why-we-invested-in-fractal-d98eaf0cdc70",children:"this Medium\npost"}),"\nfrom ",(0,r.jsx)(t.a,{href:"https://www.eon.de/de/innogy.html",children:"Innogy"}),", an early investor in\nFractal, for more information."]}),"\n",(0,r.jsxs)(t.li,{children:["In early 2018 we built a prototype of on-chain KYC using the ",(0,r.jsx)(t.a,{href:"https://github.com/ethereum/eips/issues/725",children:"ERC\n725"})," and ",(0,r.jsx)(t.a,{href:"https://github.com/ethereum/eips/issues/735",children:"ERC\n735"})," standards. See ",(0,r.jsx)(t.a,{href:"https://hackernoon.com/first-impressions-with-erc-725-and-erc-735-identity-and-claims-4a87ff2509c9",children:"our medium\npost"}),"\non this for more information."]}),"\n",(0,r.jsxs)(t.li,{children:["In late 2018, we built our first on-chain KYC integration with DIDs and\nverifiable credentials, when working with ",(0,r.jsx)(t.a,{href:"https://ixo.world/",children:"https://ixo.world/"}),". Once we\nconfirmed that a user controlled a certain address (by asking them to sign a\nnonce), we would create their DID on their behalf. Once their KYC\nverification completed, we would ledger the corresponding credential against\nthis DID. See ",(0,r.jsx)(t.a,{href:"https://medium.com/hackernoon/decentralized-identity-w3c-standards-and-the-ixo-keysafe-69d7e8d6fd7c",children:"our Medium post on\nthis"}),"\nfor more information."]}),"\n",(0,r.jsxs)(t.li,{children:["We're currently working with ",(0,r.jsx)(t.a,{href:"https://www.kilt.io/",children:"KILT"})," to deliver a\ndecentralised KYC solution for ",(0,r.jsx)(t.a,{href:"https://www.polkadex.trade/",children:"Polkadex"}),". See\n",(0,r.jsx)(t.a,{href:"https://kilt-protocol.medium.com/fractal-kilt-protocol-and-polkadex-collaborate-to-provide-decentralised-kyc-solution-for-exchange-d9d0f8c18163",children:"KILT's medium post on\nthis"}),"\nfor more information."]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"team-code-repos",children:"Team Code Repos"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://github.com/trustfractal/ink-upgrade-template",children:"https://github.com/trustfractal/ink-upgrade-template"})}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"team-linkedin-profiles",children:"Team LinkedIn Profiles"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://www.linkedin.com/in/hugopeixoto",children:"https://www.linkedin.com/in/hugopeixoto"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://www.linkedin.com/in/jvsantos",children:"https://www.linkedin.com/in/jvsantos"})}),"\n"]}),"\n",(0,r.jsxs)(t.h2,{id:"development-roadmap-nut_and_bolt",children:["Development Roadmap ","\ud83d\udd29"]}),"\n",(0,r.jsx)(t.h3,{id:"overview-1",children:"Overview"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Estimated Duration:"})," 1 month"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"FTE:"}),"  0.5"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Costs:"})," DAI 9700"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"milestone-1--upgradable-ink-smart-contract-infrastructure",children:"Milestone 1 \u2014 Upgradable Ink Smart contract infrastructure"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Estimated Duration:"})," 1 month"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"FTE:"}),"  0.5"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Costs:"})," DAI 9700"]}),"\n"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Number"}),(0,r.jsx)(t.th,{children:"Deliverable"}),(0,r.jsx)(t.th,{children:"Specification"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"0a."}),(0,r.jsx)(t.td,{children:"License"}),(0,r.jsx)(t.td,{children:"Apache 2.0"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"0b."}),(0,r.jsx)(t.td,{children:"Documentation"}),(0,r.jsx)(t.td,{children:'Documentation on how to use the smart contract template. This should answer the question "how do I build my contract in a way that lets me upgrade it afterwards?"'})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"0c."}),(0,r.jsx)(t.td,{children:"Testing Guide"}),(0,r.jsx)(t.td,{children:"The code will have unit-test coverage (min. 70%) to ensure functionality and robustness. In the guide we will describe how to run these tests"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"0d."}),(0,r.jsx)(t.td,{children:"Article/Tutorial"}),(0,r.jsx)(t.td,{children:"We will write an article or tutorial that explains the work done as part of the grant."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1."}),(0,r.jsx)(t.td,{children:"An Ink! based upgradeable Smart Contract structure"}),(0,r.jsx)(t.td,{children:"A collection of Ink! smart contracts that be used as a starting point for people that want to have upgradable smart contracts. This collection will contain upgrade logic (including authorization and data migration calls) and some sample methods that users can adapt when developing their own contracts."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"future-plans",children:"Future Plans"}),"\n",(0,r.jsx)(t.p,{children:"After milestone 1 is complete, we will analyse the resulting smart contracts\nand see if there is any pattern that would benefit from being extracted onto an\nink directive. For example, if we end up using the proxy method, we might propose\nan ink! directive that automatically generates the delegation methods."}),"\n",(0,r.jsx)(t.p,{children:"There's also the chance that some patterns or functionality would be better\nimplemented directly into the smart contracts pallet, so that other features,\nunrelated to upgrades, can take advantage of them."}),"\n",(0,r.jsxs)(t.h2,{id:"additional-information-heavy_plus_sign",children:["Additional Information ","\u2795"]}),"\n",(0,r.jsx)(t.p,{children:"This proposal is slightly research oriented."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var i=n(96540);const r={},a=i.createContext(r);function s(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);